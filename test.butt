# define user functions
function before {
  echo "before test"
}
function after {
  echo "after test"
}

# start test
butt "Example of complex butt test"

  # call user function
  before

  # some code before test
  echo "some code" \
    && echo "another code"

  # debug testing command
  debug echo -e "test$'\n'test1"

  # assert command output
  assert_equal $status 0
  assert_equal "${outlines[0]}" test
  assert_equal "${outlines[1]}" test1

  # debug another testing command
  debug 'echo "aaa bbb" | cut -d" " -f2 >&2'

  # assert command output
  assert_equal $status 0
  assert_equal $stderr bbb

  # debug another testing command (another way)
  out="$(echo "aaa bbb" | cut -d" " -f2)"

  assert_equal $? 0
  assert_equal $out bbb

  # call user function
  after

# end test
ttub

butt "Example of simple test"
  before
  debug echo "test"
  assert_equal $status 0
  assert_equal "$stdout" test
  after
ttub

butt "Example of failing test"
  before
  debug echo "test"
  assert_equal $status 0
  assert_equal "$stdout" fail
  after
ttub